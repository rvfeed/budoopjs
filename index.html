<html>
    <head>
        <link rel="stylesheet" href="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css"/>
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
        <script src="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/js/bootstrap.min.js"></script>
        <script>
        String.prototype.toString = function(){           
            return "'"+this+"'";
        }
      //  console.log(new Object("hi").toString())        
        function DataStorage(){
            this.data = [];                        
            this.searchData = function(input){  
                var searchData = this.getData();              
                return searchData[input.toString()];
            }
            this.saveData = function(data){
                localStorage.setItem("data", data);
            }
            this.getData = function(){
                return localStorage.getItem("data") || [];
            }
        }        
        function Validation(){
            //console.log(store);            
           // var formSize = document.budget.length-1;
            var form = [];                        
            this.formValidation = function(d){
                var formDup = {};
                for( var x = 0; x < d.length-1; x++){
                    if(d[x].value == ""){
                        alert("Please enter "+d[x].name);
                        return false;
                        break;
                    }                    
                    formDup[d[x].name] = d[x].value
                    if(d[x].name == "itemDate"){
                        var date = d[x].value; 
                        ///alert(date);
                    }                                                          
                }
                //form[date] =  formDup;
                form = store.getData();
                if(!form["'"+date+"'"]) form["'"+date+"'"] =  [];
                form["'"+date+"'"].push(formDup);
                console.log(form)
                console.log(store.data)

                store.saveData(form);
                return true;
            }            
        }
        function Display(){
           var HtmlOutput = function(data){
               
               var html = "";
    
                    html = data.itemName + "   "+ data.itemPrice+"   "+ data.itemDate+"\n";
                  //  console.log(html);
                return html;     
            }
            this.tempFunc = function(data){
                for(var x in data){
                    //console.log(data[i][x]);
                    var node = document.createElement("div");
                    var tnode = document.createTextNode(HtmlOutput(data[x]));
                    node.appendChild(tnode);
                    document.getElementById("result").appendChild(node);
                }
            }
            this.showData = function(data){
                console.log(data)
            document.getElementById("result").innerHTML = "";

            for(var i in data){  
               // console.log(data[i])
                   this.tempFunc(data[i]);             
             }
                
            }
            }
        
        var store = new DataStorage();
        var valid = new Validation();
        var disp = new Display();        
        function save(){
            var formSize = document.budget.length-1;                        
           if(!valid.formValidation(document.budget)) return false;
           disp.showData(store.getData());           
        }
        function search(){
            document.getElementById("result").innerHTML = "";
            disp.tempFunc(store.searchData(document.getElementById("search").value));
        }
        </script>
    </head>
    <body>
        <div class="container">
            <a href="budget_1.html" >budget</a>
  <div class="row">
    <div class="col-sm-12 col-md-9 col-lg-4">
         <div class="form-group">
        <input type="text" id="search" name="search" class="form-control" required/>
        <button onclick="search()" value="Search" >Search</button>
         </div>
      <form name="budget">
        <div class="infoMsg"ng-bind="msg"></div>
        
        <div class="form-group">
          <label for="name">Type</label>
          <input type="text" ng-model="budgetRow.item" name="itemType" id="itemType" class="form-control" required>
        </div>
                <div class="form-group">
          <label for="name">Item</label>
          <input type="text" ng-model="budgetRow.item" name="itemName" id="itemName" class="form-control" required>
        </div>
        <div class="form-group">
          <label for="price">Price</label>
          <input type="text"  ng-model="budgetRow.price" id="itemPrice" name="itemPrice" class="form-control" required>
        </div>
        <div class="form-group">
          <label for="name">Date</label>
          <input type="text" autoclose="true"  ng-model="budgetRow.date" id="itemDate" name="itemDate" class="form-control datepicker" required>
        </div>
       
        <input  type="button" class="btn btn-primary" value="Save" onclick="save()">
        <input type="reset" class="btn btn-primary" value="Clear">
      </form>
    </div>

        <div id="result"></div>
    </form>
        
    </body>
</html>